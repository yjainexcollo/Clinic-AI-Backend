# MongoDB Configuration
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/
MONGO_DB_NAME=clinicai

# Application Settings
APP_ENV=development
DEBUG=true
PORT=8000
HOST=0.0.0.0

# OpenAI Configuration (optional - not used when Azure OpenAI is configured)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.3

# Security Configuration
SECURITY_SECRET_KEY=your_secret_key_here_must_be_at_least_32_characters_long
SECURITY_ALGORITHM=HS256
SECURITY_ACCESS_TOKEN_EXPIRE_MINUTES=30

# Authentication Configuration (REQUIRED for HIPAA Compliance)
# Format: "key1:user1,key2:user2" (comma-separated key:user pairs)
# Each API key maps to a user identifier for audit logging
# Example: API_KEYS=abc123:doctor1,def456:doctor2,ghi789:nurse1
# For production, store in Azure Key Vault as secret "API-KEYS" instead
API_KEYS=your_api_key_here:user1,another_key:user2

# Encryption Key (for PHI-safe operations - must be base64-encoded 32-byte key)
ENCRYPTION_KEY=your_base64_encoded_32_byte_key_here

# CORS Configuration
CORS_ALLOWED_ORIGINS=["http://localhost:3000","http://localhost:8080"]
CORS_ALLOWED_METHODS=["GET","POST","PUT","DELETE","OPTIONS","PATCH"]
CORS_ALLOWED_HEADERS=["*"]
CORS_ALLOW_CREDENTIALS=true

# File Storage Configuration
FILE_STORAGE_TYPE=local
FILE_STORAGE_PATH=/tmp/clinicai
FILE_AUDIO_STORAGE_PATH=/tmp/clinicai/audio
FILE_CLEANUP_AFTER_HOURS=24
FILE_SAVE_AUDIO_FILES=false

# Audio Configuration
AUDIO_MAX_SIZE_MB=50
AUDIO_ALLOWED_FORMATS=["mp3","wav","m4a","flac","ogg","mpeg","mpg"]
AUDIO_TEMP_DIR=/tmp/clinicai_audio
# Note: Visit-based transcription endpoint (/notes/transcribe) has a 300-second (5-minute) request timeout
# This allows for large file uploads while preventing indefinite hangs. Files are streamed to avoid memory issues.

# Transcription Service Configuration
# Only "azure_speech" is supported (uses Azure Speech Service with speaker diarization)
TRANSCRIPTION_SERVICE=azure_speech

# Azure Speech Service Configuration (for batch transcription with speaker diarization)
# Required if TRANSCRIPTION_SERVICE=azure_speech
# IMPORTANT: Batch transcription with speaker diarization requires a "Standard" tier subscription
# Free tier subscriptions do not support batch transcription. Upgrade in Azure Portal if needed.
AZURE_SPEECH_SUBSCRIPTION_KEY=your_azure_speech_subscription_key_here
AZURE_SPEECH_REGION=eastus
AZURE_SPEECH_ENDPOINT=  # Optional - auto-generated from region if not provided
AZURE_SPEECH_ENABLE_SPEAKER_DIARIZATION=true
AZURE_SPEECH_MAX_SPEAKERS=2
AZURE_SPEECH_TRANSCRIPTION_MODE=batch  # Options: "batch" (recommended) or "realtime"
AZURE_SPEECH_BATCH_POLLING_INTERVAL=5  # Polling interval in seconds for batch transcription status (minimum 3 seconds)
AZURE_SPEECH_BATCH_MAX_WAIT_TIME=1800  # Maximum wait time in seconds for batch transcription (30 min default, can be increased for very long audio files)

# SOAP Configuration
SOAP_MODEL=gpt-4o-mini
SOAP_MAX_TOKENS=4000
SOAP_TEMPERATURE=0.3
SOAP_INCLUDE_HIGHLIGHTS=true
SOAP_INCLUDE_RED_FLAGS=true

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json

# Azure Configuration
# Azure Key Vault (optional - if not set, uses environment variables)
AZURE_KEY_VAULT_NAME=Clinic-ai-key-vault

# Azure Blob Storage
AZURE_BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=clinicaiblobstorage;AccountKey=...;EndpointSuffix=core.windows.net
AZURE_BLOB_ACCOUNT_NAME=clinicaiblobstorage
AZURE_BLOB_ACCOUNT_KEY=your_storage_account_key_here
AZURE_BLOB_CONTAINER_NAME=clinicaiblobstorage
AZURE_BLOB_DEFAULT_EXPIRY_HOURS=24
AZURE_BLOB_MAX_FILE_SIZE_MB=100

# Azure Queue Storage (uses same Storage Account as Blob Storage)
# If not set, will use AZURE_BLOB_CONNECTION_STRING
AZURE_QUEUE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=clinicaiblobstorage;AccountKey=...;EndpointSuffix=core.windows.net
AZURE_QUEUE_QUEUE_NAME=transcription-queue
AZURE_QUEUE_VISIBILITY_TIMEOUT=600
AZURE_QUEUE_MAX_RETRY_ATTEMPTS=3
AZURE_QUEUE_POLL_INTERVAL=5

# Enable transcription worker in main app (set to true to run worker in same process)
# For production, consider running worker as separate service
ENABLE_TRANSCRIPTION_WORKER=false

# Azure Application Insights (optional - for monitoring)
APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=...;IngestionEndpoint=https://...

# Azure OpenAI Configuration (preferred over OpenAI API)
# Note: Endpoint should NOT have a trailing slash
AZURE_OPENAI_ENDPOINT=https://azure-openai-clinicai.openai.azure.com
AZURE_OPENAI_API_KEY=your_azure_openai_api_key_here
AZURE_OPENAI_API_VERSION=2024-12-01-preview
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4o-mini
AZURE_OPENAI_WHISPER_DEPLOYMENT_NAME=whisper

